(function(){var G=navigator.userAgent;var L=G.match(/Chrome/i)!=null&&G.match(/Version\/\d+\.\d+(\.\d+)?\sChrome\//i)==null?true:false;var M=(G.match(/(Android);?[\s\/]+([\d.]+)?/))?true:false;var a=(G.match(/(iPad).*OS\s([\d_]+)/))?true:false;var q=(!a&&G.match(/(iPhone\sOS)\s([\d_]+)/))?true:false;var c=(q||a)&&G.match(/Safari/);var u=G.match(/MQQBrowser\/([\d\.]+)/)?true:false;var K=0;c&&(K=G.match(/Version\/([\d\.]+)/));K=parseFloat(K[1],10);var k=navigator.userAgent.indexOf("MicroMessenger")>=0;var j=false;var s="plugIn_downloadAppPlugIn_loadIframe";var t=false;var i=0;var D={};var b={};var f=null;var J={};var v=window.Zepto||window.jQuery?true:false;var g=[];var w=window.localStorage?true:false;var o="mdownloadAppPlugInskip";var p=null;function m(){var O=new Date();var P=O.getFullYear();var Q=O.getMonth()+1;var N=O.getDate();strDate=P+"-"+Q+"-"+N;return strDate}function r(){WeixinJSBridge.invoke("getInstallState",{packageName:"com.jingdong.app.mall",packageUrl:"openApp.jdMobile://"},function(O){var P=O.err_msg,N=0;if(P.indexOf("get_install_state:yes")>-1){j=true}})}function d(P,O,N){if(v){f("#"+P).bind(O,N)}else{f("#"+P).addEventListener(O,N,!1)}}function B(N){var O=(N||"mGen")+(++i);return O}if(k){if(window.WeixinJSBridge&&WeixinJSBridge.invoke){r()}else{document.addEventListener("WeixinJSBridgeReady",r,!1)}}if(v){f=window.$;J=window.$}else{f=function(N){if(typeof N=="object"){return N}return document.querySelector(N)};if(!window.$){window.$=J=f}else{J=window.$}}window.onblur=function(){for(var N=0;N<g.length;N++){clearTimeout(g[N])}};function e(P){var O=document.cookie.indexOf(P+"=");if(O==-1){return""}O=O+P.length+1;var N=document.cookie.indexOf(";",O);if(N==-1){N=document.cookie.length}return document.cookie.substring(O,N)}function l(P,R,N,S,Q){var T=P+"="+escape(R);if(N!=""){var O=new Date();O.setTime(O.getTime()+N*24*3600*1000);T+=";expires="+O.toGMTString()}if(S!=""){T+=";path="+S}if(Q!=""){T+=";domain="+Q}document.cookie=T}function H(N){var P={downAppURl:"//h5.m.jd.com/active/download/download.html?channel=jd-m",downAppIos:"//union.m.jd.com/download/go.action?to=http%3A%2F%2Fitunes.apple.com%2Fcn%2Fapp%2Fid414245413&client=apple&unionId=12532&subunionId=m-top&key=e4dd45c0f480d8a08c4621b4fff5de74",downWeixin:"http://a.app.qq.com/o/simple.jsp?pkgname=com.jingdong.app.mall&g_f=991850",downIpad:"https://itunes.apple.com/cn/app/jing-dong-hd/id434374726?mt=8",inteneUrl:"openApp.jdMobile://360buy?type=1",inteneUrlParams:null,openAppBtnId:"",closePanelBtnId:"",closePanelId:"",closeCallblack:null,closeCallblackSource:null,cookieFlag:null,noRecord:false,sourceType:"JSHOP_SOURCE_TYPE",sourceValue:"JSHOP_SOURCE_VALUE",openAppEventId:"MDownLoadFloat_OpenNow",closePanelEventId:"MDownLoadFloat_Close"};if(N){for(var O in N){if(O&&N[O]){P[O]=N[O]}}}return P}function x(P,N){var T=h(P);var Q=null;if(k){var O=null;if(j){O=T}else{O=P.downWeixin}location.href=O;return}if(a){Q=P.downIpad}else{if(q){Q=P.downAppIos}else{Q=P.downAppURl}}if(L){if(M){var S=T;T=A(S);setTimeout(function(){window.location.href=T},50)}}if(c&&K>=9){setTimeout(function(){var U=document.createElement("a");U.setAttribute("href",T),U.style.display="none",document.body.appendChild(U);var V=document.createEvent("HTMLEvents");V.initEvent("click",!1,!1),U.dispatchEvent(V)},0)}else{document.querySelector("#"+s).src=T}var R=Date.now();setTimeout(function(){if(N){var U=setTimeout(function(){y(R,Q)},1500);g.push(U)}},100)}function y(P,O){var N=Date.now();if(P&&(N-P)<(1500+200)){window.location.href=O}}function h(P){var Y=[];var S=P.inteneUrlParams;var W={category:"jump",des:"productDetail"};if(P.sourceType&&P.sourceValue){W.sourceType=P.sourceType;W.sourceValue=P.sourceValue;if(S&&!S.sourceType&&!S.sourceValue){S.sourceType=P.sourceType;S.sourceValue=P.sourceValue}}if(S){for(var X in S){if(X&&S[X]){Y.push('"'+X+'":"'+S[X]+'"')}}}else{for(var X in W){if(X&&W[X]){Y.push('"'+X+'":"'+W[X]+'"')}}}try{var T=MPing.EventSeries.getSeries();if(T){var Z=JSON.parse(T);Z.jdv=encodeURIComponent(e("__jdv"));Z.unpl=encodeURIComponent(e("unpl"));Z.mt_xid=encodeURIComponent(e("mt_xid"));Z.mt_subsite=encodeURIComponent(e("mt_subsite"))}var V={mt_subsite:encodeURIComponent(e("mt_subsite")),__jdv:encodeURIComponent(e("__jdv")),unpl:encodeURIComponent(e("unpl")),__jda:encodeURIComponent(e("__jda"))};T=JSON.stringify(Z);Y.push('"m_param":'+T);Y.push('"SE":'+JSON.stringify(V))}catch(U){Y.push('"m_param":null')}var O="{"+Y.join(",")+"}";var R=P.inteneUrl.split("?");var N=null;if(R.length==2){N=R[0]+"?"+R[1]+"&params="+O}else{N=R[0]+"?params="+O}var Q={url:"http://ccc-x.jd.com/dsp/op?openapp_url="+encodeURI(O)+"&openapp_source_type=100",method:"get",async:false,timeout:1000,error:function(){},success:function(aa){}};z(Q);return N}function A(N){return"intent://m.jd.com/#Intent;scheme="+N+";package=com.jingdong.app.mall;end"}function n(N){if(N.openAppBtnId){D[N.openAppBtnId]=N;I(N.openAppBtnId,N.openAppEventId);d(N.openAppBtnId,"click",function(){var R=this.getAttribute("id");var O=D[R];if(!t){var P=document.createElement("iframe");P.id=s;document.body.appendChild(P);document.getElementById(s).style.display="none";document.getElementById(s).style.width="0px";document.getElementById(s).style.height="0px";t=true}var Q=O.cookieFlag?"downloadAppPlugIn_downCloseDate_"+O.cookieFlag:"downloadAppPlugIn_downCloseDate";l(Q,Date.now()+"_2592000000",60,"/","m.jd.com");l(Q,Date.now()+"_2592000000",60,"/","m.jd.hk");x(O,true)})}}function F(O){if(O.closePanelBtnId&&O.closePanelId){D[O.closePanelBtnId]=O;I(O.closePanelBtnId,O.closePanelEventId);var S=O.cookieFlag?"downloadAppPlugIn_downCloseDate_"+O.cookieFlag:"downloadAppPlugIn_downCloseDate";var Q=e(S);var R=null;if(Q){R=Q.split("_");if(R.length==2){R[0]=parseInt(R[0],10);R[1]=parseInt(R[1],10)}else{R=null}}var N=Date.now();if(C(O)||(!O.noRecord&&R&&R.length==2&&(N-R[0])<R[1])){document.querySelector("#"+O.closePanelId).style.display="none";if(O.closeCallblack){var P=O.closeCallblackSource?O.closeCallblackSource:null;O.closeCallblack.call(P)}return}else{document.querySelector("#"+O.closePanelId).style.display="block"}d(O.closePanelBtnId,"click",function(){var W=this.getAttribute("id");var T=D[W];var V=T.cookieFlag?"downloadAppPlugIn_downCloseDate_"+T.cookieFlag:"downloadAppPlugIn_downCloseDate";if(!T.noRecord){l(V,Date.now()+"_259200000",60,"/","m.jd.com");l(V,Date.now()+"_259200000",60,"/","m.jd.hk")}document.querySelector("#"+T.closePanelId).style.display="none";if(T.closeCallblack){var U=T.closeCallblackSource?T.closeCallblackSource:null;T.closeCallblack.call(U)}})}}function C(Q){var R=G.indexOf("jdmsxh");var N=G.indexOf("jdmsxh2");var O=false;if(G.indexOf("Html5Plus")>=0||(R>=0&&R!=N)){O=true}if(O==false){var P={url:"//so.m.jd.com/downLoad/closeUa.action?_format_=json",method:"get",async:true,timeout:1000,error:function(){},success:function(V){V=JSON.parse(V);if(V&&V.ua){var W=V.ua.split("|");for(var T=0;T<W.length;T++){var S=W[T];if(S&&G.indexOf(S)>=0){document.querySelector("#"+Q.closePanelId).style.display="none";if(Q.closeCallblack){var U=Q.closeCallblackSource?Q.closeCallblackSource:null;Q.closeCallblack.call(U)}break}}}}};z(P)}return O}function z(O){var N;try{N=new ActiveXObject("Msxml2.XMLHTTP")}catch(Q){try{N=new ActiveXObject("Microsoft.XMLHTTP")}catch(Q){N=new XMLHttpRequest()}}N.ajaxRunError=true;try{N.open(O.method,O.url,O.async);if(O.timeout){var P=O.source?O.source:null;setTimeout(function(){if(N.ajaxRunError){N.onreadystatechange=function(){};N.abort();O.error.call(P)}},O.timeout)}N.onreadystatechange=function(){var S=O.source?O.source:null;if(N.readyState==4){if(N.status==200){N.ajaxRunError=false;var R=N.responseText;O.success.call(S,R)}else{O.error.call(S)}}};N.send(null)}catch(Q){}}function I(R,O){try{var Q=document.getElementById(R);var N=Q.className;if(N){N=N+" J_ping"}else{N="J_ping"}Q.className=N;Q.setAttribute("report-eventid",O);if(G.indexOf("jdmsxh2")>=0){Q.setAttribute("event_param",1)}else{Q.setAttribute("event_param",0)}}catch(P){}}function E(N){var O=H(N);n(O);F(O)}J.downloadAppPlugIn=E;J.downloadAppPlugInOpenApp=function(N){var O=H(N);x(O)}})();